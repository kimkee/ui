<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=768, initial-scale=1.0">
	<link href="../img/common/favicon.ico" rel="shrtcut icon">
	<title>KH</title>
	<link rel="stylesheet" href="./kh.css">
</head>
<body>
	<div class="wrap">
		<section class="sect 1st">
			<ul tit="UI">
				<li><a href="../html/guide/ui.html"></a>		<i tit="UI">,</i></li>
				<li><a href="../html/guide/index.html"></a>		<i tit="React">,</i></li>
				<li><a href="../html/guide/index2.html"></a>	<i tit="React">,</i></li>
			</ul>
			<ul tit="List">
				<li><a href="../html/guide/spin3.html"></a>		<i tit="스핀3">,</i></li>
				<li><a href="../html/guide/lottie.html"></a>	<i tit="로티">,</i></li>
				<li><a href="../html/guide/js.html"></a>		<i tit="pure js">,</i></li>
				<li><a href="../html/guide/ia.html"></a>		<i tit="pure js">,</i></li>
			</ul>
		</section>
		<section class="sect ifr">
			<div class="urls">
				<em class="time"></em>
				<em class="title"></em>
				<a href="#none" class="link-now"></a>
			</div>
			<div class="box">
				<iframe src="" class="iframe" id="myframe" name="myframe" frameborder="0" scrolling="auto" crossorigin></iframe>
			</div>
			<div class="bts">
				<a href="../html/guide/ui.html" class="bt bt-f">F</a>
			</div>
		</section>
	</div>
	<script>
		/* 김기현 */
		const tbl = new Object;
		const loctxt = "";
		let tot = 0;
		function appendHtml(el, str) {
			var div = document.createElement('div');
			div.innerHTML = str;
			while (div.children.length > 0) {
				el.appendChild(div.children[0]);
			}
		}
		document.querySelectorAll("ul").forEach((ul, i) => {
			i++;
			ul.classList.add("ul" + i);
			utit = ul.getAttribute("tit");
			tbl[ utit ] = [];
			ul.querySelectorAll("li").forEach((li, idx) => {
				idx++;
				tot++;
				li.classList.add("m" + idx);
				const btn  = li.querySelector("a");
				const fname = btn.getAttribute("href").replace(loctxt, "");
				const itits = li.querySelector("i").getAttribute("tit");
				tbl[ utit ].push( itits );
				btn.setAttribute("class", "lk");
				btn.innerHTML = fname;
				btn.setAttribute("href", loctxt + fname + "");
				btn.setAttribute("target", "_blank");
				appendHtml( li, '<a class="dk" href="#">D</a>');
				li.querySelector(".dk").setAttribute("href", loctxt + fname + "?dark=true");
			});
		});
		console.table(tbl);
		console.table("" + tot);

		let glink = localStorage.getItem("glink");

		const title = document.querySelector(".title");
		const nlink = document.querySelector(".link-now");
		const glbts = document.querySelectorAll(".sect a");
		const iframe = document.querySelector(".iframe");

		const mclick = (el, opt) => {
			var ilk = el.getAttribute("href");
			opt ? window.open(ilk, "_blank") : setLink(ilk);
		};

		const setLink = (glink) => {
			if (glink == null) { glink = loctxt + "../html/guide/ui.html" }; nlink.setAttribute("href", glink);
			nlink.innerHTML = glink.replace("../html/", "");
			iframe.setAttribute("src", glink);
			localStorage.setItem("glink", glink);
		}
		setLink(glink);

		document.getElementById('myframe').onload = function () {
			title.innerHTML = document.myframe.window.document.title;
			console.log(glink, document.myframe.window.document.title);
			setActive();
		}

		glbts.forEach((el, idx) => {
			el.addEventListener("click", (e) => {
				const opt = e.ctrlKey ? true : false ;
				mclick(el, opt)
				e.preventDefault();
			});
		});

		const setActive = () => {
			const glk = localStorage.getItem("glink");
			document.querySelectorAll("a").forEach((link) => {
				const mylink = link.getAttribute("href");
				glk == mylink ? link.classList.add("active") : link.classList.remove("active");
			});
			console.log("setActive()" , glk);
		}

		// iframe size
		const ifrm = document.querySelector(".ifr.sect");
		ifrm.addEventListener("click", (e) => {
			e.target.className == "time"
			? ifrm.classList.contains("w320")
			  ?	ifrm.classList.remove("w320")
			  : ifrm.classList.add("w320")
			: null ;
		});
		ifrm.addEventListener("transitionend", function(e){
			if( e.propertyName == "width"){
				console.log( e.propertyName );
			}
		});
		
		// 시계
		const clock = document.querySelector(".time");
		const dgit = (n) => n < 10 ? "0"+n : n;
		const ampm = (n) => n > 12 ? "PM "+ dgit( n-12 ) : "AM "+ dgit(n);
		const setT = ( ) => {
			const date = new Date();
			const time = ampm( date.getHours() ) +":"+ dgit( date.getMinutes() +":"+ dgit( date.getSeconds() ));
			clock.innerText = time;
		}
		setInterval(setT, 1000);
		
		const fetchHtml = function(url){
			fetch(url)
			.then( function(res){
				if (res.ok) {
					return res.text();
				}else{
					return "에러 error"
				}
			})
			.then( function(html){
				if(html){
					document.querySelector(".sect.lst").innerHTML = html;
					return document.querySelectorAll(".sect.lst ul>li").length;
				}
			})
			.then( function(html){
				console.log(html);
			})
		}
		// fetchHtml("./inc.html");
		
		
	</script>
</body>

</html>
